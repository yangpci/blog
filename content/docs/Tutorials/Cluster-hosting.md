---
title: "集群托管"
date: 2022-11-29
weight: 3
description: >
  对于在 kubeclipper 平台外运行的 kubernetes 集群，您可以托管至 kubeclipper 平台内进行管理，当前版本支持托管 kubeadmin 集群。
---

## Kubeadm 集群托管

托管由 kubeadm 创建和管理的 kubernetes 集群，kubeclipper 会通过 kubeconfig 文件，获取集群和节点信息，并导入到 kubeclipper 平台中。

点击“集群管理”>“集群托管”按钮进入集群托管页面，点击左上角“添加”按钮，在添加提供商弹窗中，填写提供商名称（如 kubeadm-demo）和描述后，填写以下信息：

- 区域：提供商下的集群和节点在 kubeclipper 平台中的所属区域。
- 提供商类型：选择 kubeadm。
- 节点连接方式：集群节点的连接方式，可以选择“私钥”或者“密码”，您需要确保可以通过所选方式 ssh 到集群节点。
  - 选择“私钥”，需要输入节点用户名和私钥信息。
  - 选择“密码”，需要输入节点用户名和密码信息。
- 集群名称：作为在本平台的展示名称，不能与其他集群重复。
- KubeConfig：托管集群的 KubeConfig 文件。

填写完成后点击“确定”按钮，将集群和节点导入到平台中。点击提供商名称（kubeadm-demo），进入提供商详情页，您可以查看提供商下的集群，并对提供商执行以下操作：

- 同步：系统将每隔4小时定期同步集群信息，您也可以点击“同步”按钮手动执行。
- 编辑：编辑提供商的名称、描述、访问信息、节点连接方式。
- 移除：移除集群信息，但集群不会被卸载。

## 托管集群管理

您可以点击“集群管理”>“集群”进入集群列表页面，查看包括托管集群和本地集群在内的所有集群列表，对于不同集群，支持的管理操作如下表所示：

注意：托管的 kubeadm 集群安装插件或外接存储的镜像来源会默认使用 docker.io，如果您处于离线环境，需要在安装插件时填写可访问的离线镜像仓库地址，该离线镜像仓库的地址需要预先添加到 cri 的私有镜像仓库配置，参见 [CRI 镜像仓库配置](/docs/tutorials/cluster-management/#cri-镜像仓库配置) 。

| **功能**           | **Kubeclipper 创建的集群** | **托管的 kubeadm 集群** |
| ------------------ | -------------------------- | ----------------------- |
| 查看日志           | ✔︎                          | ✔︎                       |
| 任务失败后重试     | ✔︎                          | ✔︎                       |
| 访问 kubectl       | ✔︎                          | ✔︎                       |
| 编辑               | ✔︎                          | ✔︎                       |
| 保存为模版         | ✔︎                          | ✘                       |
| CRI 镜像仓库配置   | ✔︎                          | ✔︎                       |
| 添加/移除集群节点  | ✔︎                          | ✔︎                       |
| 备份和恢复管理     | ✔︎                          | ✔︎                       |
| 版本升级           | ✔︎                          | ✘                       |
| 删除集群           | ✔︎                          | ✘                       |
| 移除集群（提供商） | /                          | ✔︎                       |
| 重置状态           | ✔︎                          | ✔︎                       |
| 集群插件管理       | ✔︎                          | ✔︎                       |
| 更新集群证书       | ✔︎                          | ✔︎                       |
| 查看 kubeconfig    | ✔︎                          | ✔︎                       |

